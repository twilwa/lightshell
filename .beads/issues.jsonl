{"id":"lightshell-4ac","title":"Per-User Memory Block Integration","description":"Wire Letta memory blocks into voice conversation flow. See openspec/changes/add-per-user-memory/","status":"closed","priority":2,"issue_type":"epic","owner":"spywarezzz@proton.me","created_at":"2026-01-29T19:06:35.464599-08:00","created_by":"twilwa","updated_at":"2026-01-29T19:23:03.48741-08:00","closed_at":"2026-01-29T19:23:03.48741-08:00","close_reason":"All 19 child tasks completed - Per-User Memory Block Integration feature complete"}
{"id":"lightshell-4ac.1","title":"Create MemoryManager class with config","description":"Create src/memory/manager.ts with LettaClient and agentId config. Export class with constructor.","status":"closed","priority":2,"issue_type":"task","owner":"spywarezzz@proton.me","created_at":"2026-01-29T19:06:48.22172-08:00","created_by":"twilwa","updated_at":"2026-01-29T19:08:51.967856-08:00","closed_at":"2026-01-29T19:08:51.967856-08:00","close_reason":"Closed","dependencies":[{"issue_id":"lightshell-4ac.1","depends_on_id":"lightshell-4ac","type":"parent-child","created_at":"2026-01-29T19:06:48.222591-08:00","created_by":"twilwa"}]}
{"id":"lightshell-4ac.10","title":"Ensure detach in finally block","description":"Detach must run even on LLM error. Use try/finally pattern. Log but don't rethrow detach errors.","status":"closed","priority":2,"issue_type":"task","owner":"spywarezzz@proton.me","created_at":"2026-01-29T19:07:07.842413-08:00","created_by":"twilwa","updated_at":"2026-01-29T19:17:00.253482-08:00","closed_at":"2026-01-29T19:17:00.253482-08:00","close_reason":"Already implemented in task 4ac.7 - finally block at lines 215-219","dependencies":[{"issue_id":"lightshell-4ac.10","depends_on_id":"lightshell-4ac","type":"parent-child","created_at":"2026-01-29T19:07:07.843078-08:00","created_by":"twilwa"},{"issue_id":"lightshell-4ac.10","depends_on_id":"lightshell-4ac.7","type":"blocks","created_at":"2026-01-29T19:07:08.585943-08:00","created_by":"twilwa"}]}
{"id":"lightshell-4ac.11","title":"Log but don't fail on attachment errors","description":"Emit 'memoryAttachFailed' event with error. Continue processing. Add degradedMode flag to state.","status":"closed","priority":2,"issue_type":"task","owner":"spywarezzz@proton.me","created_at":"2026-01-29T19:07:17.990151-08:00","created_by":"twilwa","updated_at":"2026-01-29T19:11:36.861665-08:00","closed_at":"2026-01-29T19:11:36.861665-08:00","close_reason":"Closed","dependencies":[{"issue_id":"lightshell-4ac.11","depends_on_id":"lightshell-4ac","type":"parent-child","created_at":"2026-01-29T19:07:17.990983-08:00","created_by":"twilwa"},{"issue_id":"lightshell-4ac.11","depends_on_id":"lightshell-4ac.5","type":"blocks","created_at":"2026-01-29T19:07:18.677791-08:00","created_by":"twilwa"}]}
{"id":"lightshell-4ac.12","title":"Log but don't fail on detachment errors","description":"Emit 'memoryDetachFailed' event. No exception to caller. Critical for cleanup reliability.","status":"closed","priority":2,"issue_type":"task","owner":"spywarezzz@proton.me","created_at":"2026-01-29T19:07:18.161173-08:00","created_by":"twilwa","updated_at":"2026-01-29T19:13:16.532922-08:00","closed_at":"2026-01-29T19:13:16.532922-08:00","close_reason":"Closed","dependencies":[{"issue_id":"lightshell-4ac.12","depends_on_id":"lightshell-4ac","type":"parent-child","created_at":"2026-01-29T19:07:18.162359-08:00","created_by":"twilwa"},{"issue_id":"lightshell-4ac.12","depends_on_id":"lightshell-4ac.11","type":"blocks","created_at":"2026-01-29T19:07:18.840579-08:00","created_by":"twilwa"}]}
{"id":"lightshell-4ac.13","title":"Add metrics events for memory latency","description":"Emit 'memoryOperationComplete' with {operation, durationMs, success}. Track attach/detach separately.","status":"closed","priority":2,"issue_type":"task","owner":"spywarezzz@proton.me","created_at":"2026-01-29T19:07:18.338752-08:00","created_by":"twilwa","updated_at":"2026-01-29T19:13:16.696879-08:00","closed_at":"2026-01-29T19:13:16.696879-08:00","close_reason":"Closed","dependencies":[{"issue_id":"lightshell-4ac.13","depends_on_id":"lightshell-4ac","type":"parent-child","created_at":"2026-01-29T19:07:18.339707-08:00","created_by":"twilwa"},{"issue_id":"lightshell-4ac.13","depends_on_id":"lightshell-4ac.11","type":"blocks","created_at":"2026-01-29T19:07:18.998471-08:00","created_by":"twilwa"}]}
{"id":"lightshell-4ac.14","title":"Handle Letta server unavailable","description":"Detect connection refused / timeout. Set serverUnavailable state. Skip memory ops until reconnect.","status":"closed","priority":2,"issue_type":"task","owner":"spywarezzz@proton.me","created_at":"2026-01-29T19:07:18.515882-08:00","created_by":"twilwa","updated_at":"2026-01-29T19:14:43.834753-08:00","closed_at":"2026-01-29T19:14:43.834753-08:00","close_reason":"Closed","dependencies":[{"issue_id":"lightshell-4ac.14","depends_on_id":"lightshell-4ac","type":"parent-child","created_at":"2026-01-29T19:07:18.516777-08:00","created_by":"twilwa"},{"issue_id":"lightshell-4ac.14","depends_on_id":"lightshell-4ac.13","type":"blocks","created_at":"2026-01-29T19:07:19.153321-08:00","created_by":"twilwa"}]}
{"id":"lightshell-4ac.15","title":"Unit test MemoryManager attach/detach lifecycle","description":"Test attach creates block, attaches to agent. Test detach removes. Test multiple attach/detach cycles.","status":"closed","priority":2,"issue_type":"task","owner":"spywarezzz@proton.me","created_at":"2026-01-29T19:07:29.597257-08:00","created_by":"twilwa","updated_at":"2026-01-29T19:19:18.65129-08:00","closed_at":"2026-01-29T19:19:18.65129-08:00","close_reason":"Closed","dependencies":[{"issue_id":"lightshell-4ac.15","depends_on_id":"lightshell-4ac","type":"parent-child","created_at":"2026-01-29T19:07:29.598531-08:00","created_by":"twilwa"},{"issue_id":"lightshell-4ac.15","depends_on_id":"lightshell-4ac.10","type":"blocks","created_at":"2026-01-29T19:07:30.366385-08:00","created_by":"twilwa"},{"issue_id":"lightshell-4ac.15","depends_on_id":"lightshell-4ac.14","type":"blocks","created_at":"2026-01-29T19:07:30.511575-08:00","created_by":"twilwa"}]}
{"id":"lightshell-4ac.16","title":"Unit test error tolerance (409, 404)","description":"Mock Letta client to return 409 on attach, 404 on detach. Verify no exceptions thrown.","status":"closed","priority":2,"issue_type":"task","owner":"spywarezzz@proton.me","created_at":"2026-01-29T19:07:29.760139-08:00","created_by":"twilwa","updated_at":"2026-01-29T19:19:36.471627-08:00","closed_at":"2026-01-29T19:19:36.471627-08:00","close_reason":"Already covered in blocks.test.ts (lines 61-94, 122-141) and manager.test.ts error tolerance tests","dependencies":[{"issue_id":"lightshell-4ac.16","depends_on_id":"lightshell-4ac","type":"parent-child","created_at":"2026-01-29T19:07:29.76086-08:00","created_by":"twilwa"},{"issue_id":"lightshell-4ac.16","depends_on_id":"lightshell-4ac.15","type":"blocks","created_at":"2026-01-29T19:07:30.657497-08:00","created_by":"twilwa"}]}
{"id":"lightshell-4ac.17","title":"Unit test cleanup on destroy","description":"Attach blocks, call destroy(), verify all detached. Test partial failures during cleanup.","status":"closed","priority":2,"issue_type":"task","owner":"spywarezzz@proton.me","created_at":"2026-01-29T19:07:29.915862-08:00","created_by":"twilwa","updated_at":"2026-01-29T19:19:36.644229-08:00","closed_at":"2026-01-29T19:19:36.644229-08:00","close_reason":"Already covered in manager.test.ts describe('destroy') block - 4 tests","dependencies":[{"issue_id":"lightshell-4ac.17","depends_on_id":"lightshell-4ac","type":"parent-child","created_at":"2026-01-29T19:07:29.916634-08:00","created_by":"twilwa"},{"issue_id":"lightshell-4ac.17","depends_on_id":"lightshell-4ac.15","type":"blocks","created_at":"2026-01-29T19:07:30.804644-08:00","created_by":"twilwa"}]}
{"id":"lightshell-4ac.18","title":"Integration test with mocked Letta","description":"Create mock Letta client. Test full attach-process-detach cycle. Verify block labels correct.","status":"closed","priority":2,"issue_type":"task","owner":"spywarezzz@proton.me","created_at":"2026-01-29T19:07:30.066151-08:00","created_by":"twilwa","updated_at":"2026-01-29T19:20:50.492602-08:00","closed_at":"2026-01-29T19:20:50.492602-08:00","close_reason":"Closed","dependencies":[{"issue_id":"lightshell-4ac.18","depends_on_id":"lightshell-4ac","type":"parent-child","created_at":"2026-01-29T19:07:30.066834-08:00","created_by":"twilwa"},{"issue_id":"lightshell-4ac.18","depends_on_id":"lightshell-4ac.16","type":"blocks","created_at":"2026-01-29T19:07:30.952099-08:00","created_by":"twilwa"},{"issue_id":"lightshell-4ac.18","depends_on_id":"lightshell-4ac.17","type":"blocks","created_at":"2026-01-29T19:07:31.096088-08:00","created_by":"twilwa"}]}
{"id":"lightshell-4ac.19","title":"Test VoiceOrchestrator with memory enabled","description":"Integration test: transcript -\u003e memory attach -\u003e LLM call -\u003e memory detach. Verify userId flows through.","status":"closed","priority":2,"issue_type":"task","owner":"spywarezzz@proton.me","created_at":"2026-01-29T19:07:30.223197-08:00","created_by":"twilwa","updated_at":"2026-01-29T19:22:54.914619-08:00","closed_at":"2026-01-29T19:22:54.914619-08:00","close_reason":"Closed","dependencies":[{"issue_id":"lightshell-4ac.19","depends_on_id":"lightshell-4ac","type":"parent-child","created_at":"2026-01-29T19:07:30.224004-08:00","created_by":"twilwa"},{"issue_id":"lightshell-4ac.19","depends_on_id":"lightshell-4ac.18","type":"blocks","created_at":"2026-01-29T19:07:31.241363-08:00","created_by":"twilwa"}]}
{"id":"lightshell-4ac.2","title":"Implement attachUserBlocks(userId)","description":"Get-or-create user block via existing blocks.ts, then attach to agent. Return block IDs for tracking.","status":"closed","priority":2,"issue_type":"task","owner":"spywarezzz@proton.me","created_at":"2026-01-29T19:06:48.388665-08:00","created_by":"twilwa","updated_at":"2026-01-29T19:10:10.457751-08:00","closed_at":"2026-01-29T19:10:10.457751-08:00","close_reason":"Closed","dependencies":[{"issue_id":"lightshell-4ac.2","depends_on_id":"lightshell-4ac","type":"parent-child","created_at":"2026-01-29T19:06:48.389499-08:00","created_by":"twilwa"},{"issue_id":"lightshell-4ac.2","depends_on_id":"lightshell-4ac.1","type":"blocks","created_at":"2026-01-29T19:06:49.023387-08:00","created_by":"twilwa"}]}
{"id":"lightshell-4ac.3","title":"Implement detachUserBlocks(blockIds)","description":"Batch detach with error tolerance. Use existing detachBlockFromAgent. Don't throw on failures.","status":"closed","priority":2,"issue_type":"task","owner":"spywarezzz@proton.me","created_at":"2026-01-29T19:06:48.549151-08:00","created_by":"twilwa","updated_at":"2026-01-29T19:11:36.694995-08:00","closed_at":"2026-01-29T19:11:36.694995-08:00","close_reason":"Closed","dependencies":[{"issue_id":"lightshell-4ac.3","depends_on_id":"lightshell-4ac","type":"parent-child","created_at":"2026-01-29T19:06:48.549829-08:00","created_by":"twilwa"},{"issue_id":"lightshell-4ac.3","depends_on_id":"lightshell-4ac.1","type":"blocks","created_at":"2026-01-29T19:06:49.172672-08:00","created_by":"twilwa"},{"issue_id":"lightshell-4ac.3","depends_on_id":"lightshell-4ac.2","type":"blocks","created_at":"2026-01-29T19:06:49.607033-08:00","created_by":"twilwa"}]}
{"id":"lightshell-4ac.4","title":"Track attached blocks for cleanup","description":"Add Set\u003cstring\u003e to track currently attached blocks. Clear on detach. Detach all on destroy().","status":"closed","priority":2,"issue_type":"task","owner":"spywarezzz@proton.me","created_at":"2026-01-29T19:06:48.703748-08:00","created_by":"twilwa","updated_at":"2026-01-29T19:13:16.380885-08:00","closed_at":"2026-01-29T19:13:16.380885-08:00","close_reason":"Closed","dependencies":[{"issue_id":"lightshell-4ac.4","depends_on_id":"lightshell-4ac","type":"parent-child","created_at":"2026-01-29T19:06:48.704409-08:00","created_by":"twilwa"},{"issue_id":"lightshell-4ac.4","depends_on_id":"lightshell-4ac.1","type":"blocks","created_at":"2026-01-29T19:06:49.318609-08:00","created_by":"twilwa"},{"issue_id":"lightshell-4ac.4","depends_on_id":"lightshell-4ac.3","type":"blocks","created_at":"2026-01-29T19:06:49.751345-08:00","created_by":"twilwa"}]}
{"id":"lightshell-4ac.5","title":"Add timeout handling for Letta API","description":"Wrap Letta calls with Promise.race timeout. Default 5s. Configurable via MemoryManagerConfig.","status":"closed","priority":2,"issue_type":"task","owner":"spywarezzz@proton.me","created_at":"2026-01-29T19:06:48.871829-08:00","created_by":"twilwa","updated_at":"2026-01-29T19:10:10.612448-08:00","closed_at":"2026-01-29T19:10:10.612448-08:00","close_reason":"Closed","dependencies":[{"issue_id":"lightshell-4ac.5","depends_on_id":"lightshell-4ac","type":"parent-child","created_at":"2026-01-29T19:06:48.872478-08:00","created_by":"twilwa"},{"issue_id":"lightshell-4ac.5","depends_on_id":"lightshell-4ac.1","type":"blocks","created_at":"2026-01-29T19:06:49.463841-08:00","created_by":"twilwa"}]}
{"id":"lightshell-4ac.6","title":"Add MemoryManager to VoiceOrchestratorConfig","description":"Add optional memoryManager?: MemoryManager to VoiceOrchestratorConfig interface. Store in this.memoryManager.","status":"closed","priority":2,"issue_type":"task","owner":"spywarezzz@proton.me","created_at":"2026-01-29T19:07:07.192052-08:00","created_by":"twilwa","updated_at":"2026-01-29T19:14:43.683572-08:00","closed_at":"2026-01-29T19:14:43.683572-08:00","close_reason":"Closed","dependencies":[{"issue_id":"lightshell-4ac.6","depends_on_id":"lightshell-4ac","type":"parent-child","created_at":"2026-01-29T19:07:07.192796-08:00","created_by":"twilwa"},{"issue_id":"lightshell-4ac.6","depends_on_id":"lightshell-4ac.4","type":"blocks","created_at":"2026-01-29T19:07:08.00725-08:00","created_by":"twilwa"}]}
{"id":"lightshell-4ac.7","title":"Wrap generateResponse with attach/detach","description":"In processAndRespond(), call memoryManager.attachUserBlocks before generateResponse, detach in finally block.","status":"closed","priority":2,"issue_type":"task","owner":"spywarezzz@proton.me","created_at":"2026-01-29T19:07:07.343717-08:00","created_by":"twilwa","updated_at":"2026-01-29T19:16:32.27987-08:00","closed_at":"2026-01-29T19:16:32.27987-08:00","close_reason":"Closed","dependencies":[{"issue_id":"lightshell-4ac.7","depends_on_id":"lightshell-4ac","type":"parent-child","created_at":"2026-01-29T19:07:07.344672-08:00","created_by":"twilwa"},{"issue_id":"lightshell-4ac.7","depends_on_id":"lightshell-4ac.6","type":"blocks","created_at":"2026-01-29T19:07:08.150495-08:00","created_by":"twilwa"}]}
{"id":"lightshell-4ac.8","title":"Pass userId from TranscriptionEvent","description":"TranscriptionEvent already has userId. Pass it through to memory attachment. Handle undefined userId gracefully.","status":"closed","priority":2,"issue_type":"task","owner":"spywarezzz@proton.me","created_at":"2026-01-29T19:07:07.499439-08:00","created_by":"twilwa","updated_at":"2026-01-29T19:16:59.947122-08:00","closed_at":"2026-01-29T19:16:59.947122-08:00","close_reason":"Already implemented in task 4ac.7 - userId passed at line 191","dependencies":[{"issue_id":"lightshell-4ac.8","depends_on_id":"lightshell-4ac","type":"parent-child","created_at":"2026-01-29T19:07:07.5001-08:00","created_by":"twilwa"},{"issue_id":"lightshell-4ac.8","depends_on_id":"lightshell-4ac.7","type":"blocks","created_at":"2026-01-29T19:07:08.294268-08:00","created_by":"twilwa"}]}
{"id":"lightshell-4ac.9","title":"Handle attachment failures gracefully","description":"Wrap attach in try/catch. Log warning but continue without memory. Set flag for degraded mode.","status":"closed","priority":2,"issue_type":"task","owner":"spywarezzz@proton.me","created_at":"2026-01-29T19:07:07.656964-08:00","created_by":"twilwa","updated_at":"2026-01-29T19:17:00.097132-08:00","closed_at":"2026-01-29T19:17:00.097132-08:00","close_reason":"Already implemented in MemoryManager.attachUserBlocks try/catch","dependencies":[{"issue_id":"lightshell-4ac.9","depends_on_id":"lightshell-4ac","type":"parent-child","created_at":"2026-01-29T19:07:07.657937-08:00","created_by":"twilwa"},{"issue_id":"lightshell-4ac.9","depends_on_id":"lightshell-4ac.7","type":"blocks","created_at":"2026-01-29T19:07:08.440853-08:00","created_by":"twilwa"}]}
